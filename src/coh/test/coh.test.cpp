#define CATCH_CONFIG_MAIN
#include "catch.hpp"
#include "coh/coh.h"


TEST_CASE( "coh" ){
  GIVEN( "" ){
    WHEN( "" ){
      double temp = 296.0, emax = 0.625;
      int lat = 1, numAtoms = 1;
      double tol = 5e-2;
      std::vector<double> eGrid;
      eGrid = { 1.0000E-5, 1.0625E-5, 1.1250E-5, 1.1875E-5, 1.2500E-5, 1.3750E-5, 
        1.5000E-5, 1.6250E-5, 1.7500E-5, 1.8750E-5, 2.0000E-5, 2.1875E-5, 
        2.3750E-5, 2.5625E-5, 2.7500E-5, 2.9375E-5, 3.1250E-5, 3.3125E-5, 
        3.5000E-5, 3.8750E-5, 4.2500E-5, 4.6250E-5, 5.0000E-5, 5.3125E-5, 
        5.6250E-5, 5.9375E-5, 6.2500E-5, 6.8750E-5, 7.5000E-5, 8.1250E-5, 
        8.7500E-5, 9.3750E-5, 1.0000E-4, 1.0625E-4, 1.1250E-4, 1.1875E-4, 
        1.2500E-4, 1.3750E-4, 1.5000E-4, 1.6250E-4, 1.7500E-4, 1.8750E-4, 
        2.0000E-4, 2.1875E-4, 2.3750E-4, 2.5625E-4, 2.7500E-4, 2.9375E-4, 
        3.1250E-4, 3.3125E-4, 3.5000E-4, 3.8750E-4, 4.2500E-4, 4.6250E-4, 
        5.0000E-4, 5.3125E-4, 5.6250E-4, 5.9375E-4, 6.2500E-4, 6.8750E-4, 
        7.5000E-4, 8.1250E-4, 8.7500E-4, 9.3750E-4, 1.0000E-3, 1.0625E-3, 
        1.1250E-3, 1.1875E-3, 1.2500E-3, 1.3750E-3, 1.5000E-3, 1.6250E-3, 
        1.7500E-3, 1.8750E-3, 2.0000E-3, 2.1875E-3, 2.3750E-3, 2.5625E-3, 
        2.7500E-3, 2.9375E-3, 3.1250E-3, 3.3125E-3, 3.5000E-3, 3.8750E-3, 
        4.2500E-3, 4.6250E-3, 5.0000E-3, 5.3125E-3, 5.6250E-3, 5.9375E-3, 
        6.2500E-3, 6.8750E-3, 7.5000E-3, 8.1250E-3, 8.7500E-3, 9.3750E-3, 
        1.0000E-2, 1.0625E-2, 1.1250E-2, 1.1875E-2, 1.2500E-2, 1.3750E-2, 
        1.5000E-2, 1.6250E-2, 1.7500E-2, 1.8750E-2, 2.0000E-2, 2.1325E-2, 
        2.2650E-2, 2.3975E-2, 2.5300E-2, 2.684375E-2, 2.838750E-2, 3.1475E-2, 
        3.4562E-2, 3.7650E-2, 4.0737E-2, 4.3825E-2, 4.691250E-2, 5.0000E-2, 
        5.3125E-2, 5.6250E-2, 5.9375E-2, 6.2500E-2, 6.8750E-2, 7.5000E-2, 
        8.1250E-2, 8.7500E-2, 9.3750E-2, 1.0000E-1, 1.0625E-1, 1.1250E-1, 
        1.1875E-1, 1.2500E-1, 1.3750E-1, 1.5000E-1, 1.6250E-1, 1.7500E-1, 
        1.8750E-1, 2.0000E-1, 2.1875E-1, 2.3750E-1, 2.5625E-1, 2.7500E-1, 
        2.9375E-1, 3.1250E-1, 3.3125E-1, 3.5000E-1, 3.8750E-1, 4.2500E-1, 
        5.0000E-1, 6.2500E-1, 6.250062E-1 };
      std::cout.precision(9);
      auto finalE = coh(temp,lat,emax,numAtoms,eGrid,tol);

      std::vector<double> correct_finalE { 1.000000E-5, 1.062500E-5, 1.125000E-5, 
      1.187500E-5, 1.250000E-5, 1.375000E-5, 1.500000E-5, 1.625000E-5, 1.750000E-5, 
      1.875000E-5, 2.000000E-5, 2.187500E-5, 2.375000E-5, 2.562500E-5, 2.750000E-5, 
      2.937500E-5, 3.125000E-5, 3.312500E-5, 3.500000E-5, 3.875000E-5, 4.250000E-5, 
      4.625000E-5, 5.000000E-5, 5.312500E-5, 5.625000E-5, 5.937500E-5, 6.250000E-5, 
      6.875000E-5, 7.500000E-5, 8.125000E-5, 8.750000E-5, 9.375000E-5, 1.000000E-4, 
      1.062500E-4, 1.125000E-4, 1.187500E-4, 1.250000E-4, 1.375000E-4, 1.500000E-4, 
      1.625000E-4, 1.750000E-4, 1.875000E-4, 2.000000E-4, 2.187500E-4, 2.375000E-4, 
      2.562500E-4, 2.750000E-4, 2.937500E-4, 3.125000E-4, 3.312500E-4, 3.500000E-4, 
      3.875000E-4, 4.250000E-4, 4.555814E-4, 4.555816E-4, 4.625000E-4, 5.000000E-4, 
      5.312500E-4, 5.625000E-4, 5.937500E-4, 6.250000E-4, 6.875000E-4, 7.500000E-4, 
      8.125000E-4, 8.750000E-4, 9.375000E-4, 1.000000E-3, 1.062500E-3, 1.125000E-3, 
      1.187500E-3, 1.250000E-3, 1.375000E-3, 1.500000E-3, 1.625000E-3, 1.750000E-3, 
      1.822325E-3, 1.822327E-3, 1.875000E-3, 2.000000E-3, 2.187500E-3, 2.375000E-3, 
      2.562500E-3, 2.750000E-3, 2.937500E-3, 3.125000E-3, 3.312500E-3, 3.500000E-3, 
      3.875000E-3, 4.100232E-3, 4.100234E-3, 4.250000E-3, 4.515834E-3, 4.515836E-3, 
      4.625000E-3, 4.971415E-3, 4.971417E-3, 5.000000E-3, 5.312500E-3, 5.625000E-3, 
      5.937500E-3, 6.250000E-3, 6.338160E-3, 6.338162E-3, 6.875000E-3, 7.289303E-3, 
      7.289305E-3, 7.500000E-3, 8.125000E-3, 8.616067E-3, 8.616069E-3, 8.750000E-3, 
      9.375000E-3, 1.000000E-2, 1.062500E-2, 1.125000E-2, 1.138953E-2, 1.138955E-2, 
      1.180513E-2, 1.180515E-2, 1.187500E-2, 1.250000E-2, 1.354749E-2, 1.354751E-2, 
      1.375000E-2, 1.400308E-2, 1.400310E-2, 1.500000E-2, 1.536982E-2, 1.536984E-2, 
      1.590536E-2, 1.590538E-2, 1.625000E-2, 1.640092E-2, 1.640094E-2, 1.750000E-2, 
      1.764773E-2, 1.764775E-2, 1.806333E-2, 1.806335E-2, 1.851891E-2, 1.851893E-2, 
      1.875000E-2, 1.988565E-2, 1.988567E-2, 2.000000E-2, 2.083680E-2, 2.083682E-2, 
      2.091676E-2, 2.091678E-2, 2.132500E-2, 2.216356E-2, 2.216358E-2, 2.232348E-2, 
      2.232350E-2, 2.265000E-2, 2.397500E-2, 2.493703E-2, 2.493705E-2, 2.530000E-2, 
      2.535263E-2, 2.535265E-2, 2.683932E-2, 2.683934E-2, 2.684375E-2, 2.838750E-2, 
      2.915720E-2, 2.915722E-2, 2.945287E-2, 2.945289E-2, 2.994843E-2, 2.994845E-2, 
      3.147500E-2, 3.161083E-2, 3.161085E-2, 3.206641E-2, 3.206643E-2, 3.343316E-2, 
      3.343318E-2, 3.367304E-2, 3.367306E-2, 3.446426E-2, 3.446428E-2, 3.456250E-2, 
      3.571107E-2, 3.571109E-2, 3.587099E-2, 3.587101E-2, 3.690209E-2, 3.690211E-2, 
      3.765000E-2, 3.890014E-2, 3.890016E-2, 4.038682E-2, 4.038684E-2, 4.064250E-2, 
      4.064252E-2, 4.073750E-2, 4.109808E-2, 4.109810E-2, 4.141792E-2, 4.141794E-2, 
      4.246483E-2, 4.246485E-2, 4.270471E-2, 4.270473E-2, 4.300037E-2, 4.300039E-2, 
      4.382500E-2, 4.474274E-2, 4.474276E-2, 4.555814E-2, 4.555816E-2, 4.691250E-2, 
      4.722054E-2, 4.722056E-2, 4.793181E-2, 4.793183E-2, 4.801177E-2, 4.801179E-2, 
      5.000000E-2, 5.007397E-2, 5.007399E-2, 5.312500E-2, 5.393433E-2, 5.393435E-2, 
      5.496543E-2, 5.496545E-2, 5.512535E-2, 5.512537E-2, 5.625000E-2, 5.829024E-2, 
      5.829026E-2, 5.870584E-2, 5.870586E-2, 5.910564E-2, 5.910566E-2, 5.937500E-2, 
      5.964118E-2, 5.964120E-2, 6.250000E-2, 6.280607E-2, 6.280609E-2, 6.296599E-2, 
      6.296601E-2, 6.362148E-2, 6.362150E-2, 6.560372E-2, 6.560374E-2, 6.875000E-2, 
      6.979972E-2, 6.979974E-2, 7.011956E-2, 7.011958E-2, 7.407567E-2, 7.407569E-2, 
      7.500000E-2, 7.699326E-2, 7.699328E-2, 8.102933E-2, 8.102935E-2, 8.125000E-2, 
      8.150909E-2, 8.150911E-2, 8.580085E-2, 8.580087E-2, 8.620065E-2, 8.620067E-2, 
      8.750000E-2, 8.929396E-2, 8.929398E-2, 9.375000E-2, 9.380979E-2, 9.380981E-2, 
      9.893275E-2, 9.893277E-2, 1.000000E-1, 1.014105E-1, 1.014107E-1, 1.025057E-1, 
      1.025059E-1, 1.062500E-1, 1.081243E-1, 1.081245E-1, 1.086040E-1, 1.086042E-1, 
      1.091554E-1, 1.091556E-1, 1.125000E-1, 1.147181E-1, 1.147183E-1, 1.166288E-1, 
      1.166290E-1, 1.187500E-1, 1.227029E-1, 1.227031E-1, 1.239896E-1, 1.239898E-1, 
      1.242853E-1, 1.242855E-1, 1.250000E-1, 1.273786E-1, 1.273788E-1, 1.299364E-1, 
      1.299366E-1, 1.316629E-1, 1.316631E-1, 1.375000E-1, 1.383284E-1, 1.383286E-1, 
      1.399908E-1, 1.399910E-1, 1.403906E-1, 1.403908E-1, 1.420530E-1, 1.420532E-1, 
      1.431482E-1, 1.431484E-1, 1.476083E-1, 1.476085E-1, 1.500000E-1, 1.556005E-1, 
      1.556007E-1, 1.563917E-1, 1.563919E-1, 1.572713E-1, 1.572715E-1, 1.625000E-1, 
      1.644648E-1, 1.644650E-1, 1.739595E-1, 1.739597E-1, 1.747591E-1, 1.747593E-1, 
      1.750000E-1, 1.822325E-1, 1.822327E-1, 1.875000E-1, 1.917272E-1, 1.917274E-1, 
      2.000000E-1, 2.002958E-1, 2.002960E-1, 2.009113E-1, 2.009115E-1, 2.112214E-1, 
      2.112216E-1, 2.114613E-1, 2.114615E-1, 2.138433E-1, 2.138435E-1, 2.144588E-1, 
      2.144590E-1, 2.154016E-1, 2.154018E-1, 2.187500E-1, 2.189747E-1, 2.189749E-1, 
      2.205013E-1, 2.205015E-1, 2.325222E-1, 2.325224E-1, 2.326653E-1, 2.326655E-1, 
      2.367182E-1, 2.367184E-1, 2.375000E-1, 2.385647E-1, 2.385649E-1, 2.410025E-1, 
      2.410027E-1, 2.531107E-1, 2.531109E-1, 2.544858E-1, 2.544860E-1, 2.562500E-1, 
      2.590658E-1, 2.590660E-1, 2.624148E-1, 2.624150E-1, 2.750000E-1, 2.759214E-1, 
      2.759216E-1, 2.759623E-1, 2.759625E-1, 2.764012E-1, 2.764014E-1, 2.773607E-1, 
      2.773609E-1, 2.804782E-1, 2.804784E-1, 2.847383E-1, 2.847385E-1, 2.937500E-1, 
      2.997084E-1, 2.997086E-1, 3.004029E-1, 3.004031E-1, 3.028017E-1, 3.028019E-1, 
      3.079730E-1, 3.079732E-1, 3.125000E-1, 3.237259E-1, 3.237261E-1, 3.237816E-1, 
      3.237818E-1, 3.253808E-1, 3.253810E-1, 3.260363E-1, 3.260365E-1, 3.312500E-1, 
      3.321188E-1, 3.321190E-1, 3.493184E-1, 3.493186E-1, 3.500000E-1, 3.501821E-1, 
      3.501823E-1, 3.571758E-1, 3.571760E-1, 3.752140E-1, 3.752142E-1, 3.752391E-1, 
      3.752393E-1, 3.831439E-1, 3.831441E-1, 3.875000E-1, 4.023090E-1, 4.023092E-1, 
      4.024057E-1, 4.024059E-1, 4.026846E-1, 4.026848E-1, 4.035084E-1, 4.035086E-1, 
      4.035725E-1, 4.035727E-1, 4.043722E-1, 4.043724E-1, 4.100232E-1, 4.100234E-1, 
      4.250000E-1, 4.313621E-1, 4.313623E-1, 4.313862E-1, 4.313864E-1, 4.366217E-1, 
      4.366219E-1, 4.378137E-1, 4.378139E-1, 4.598322E-1, 4.598324E-1, 4.603594E-1, 
      4.603596E-1, 4.608559E-1, 4.608561E-1, 4.613189E-1, 4.613191E-1, 4.622784E-1, 
      4.622786E-1, 4.665153E-1, 4.665155E-1, 4.899248E-1, 4.899250E-1, 4.946888E-1, 
      4.946890E-1, 4.960398E-1, 4.960400E-1, 4.961281E-1, 4.961283E-1, 5.000000E-1, 
      5.212158E-1, 5.212160E-1, 5.229191E-1, 5.229193E-1, 5.266521E-1, 5.266523E-1, 
      5.533138E-1, 5.533140E-1, 5.533947E-1, 5.533949E-1, 5.580872E-1, 5.580874E-1, 
      5.861408E-1, 5.861410E-1, 5.862839E-1, 5.862841E-1, 5.904335E-1, 5.904337E-1, 
      6.202685E-1, 6.202687E-1, 6.203326E-1, 6.203328E-1, 6.211322E-1, 6.211324E-1, 
      6.236909E-1, 6.236911E-1, 6.249999E-1, 6.250000E-1, 6.250001E-1, 2.000000E+7 };

      //std::cout << finalE.size() << std::endl;
      //std::cout << correct_finalE.size() << std::endl;



      
      REQUIRE( true );
      
    } // WHEN
  } // GIVEN
} // TEST CASE
