

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; leapr  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="QuickStart" href="quickStart.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: red" >
          

          
            <a href="index.html" class="icon icon-home"> leapr
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#incoherent-scattering-elastic-and-inelastic">Incoherent Scattering (Elastic and Inelastic)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#continuous-treatment">Continuous Treatment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#translational-behavior">Translational Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#discrete-oscillators">Discrete Oscillators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coherent-scattering-elastic">Coherent Scattering (Elastic)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hexagonal-lattices">Hexagonal Lattices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hexagonal-close-packed">Hexagonal Close Packed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#face-centered-cubic">Face Centered Cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#body-centered-cubic">Body Centered Cubic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coherent-scattering-inelastic-approximations">Coherent Scattering (Inelastic) Approximations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#skold-and-vineyard">Skold and Vineyard</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cold-hydrogen-and-deuterium">Cold Hydrogen and Deuterium</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#special-cases-and-misc-functions">Special Cases and Misc. Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#short-collision-time-approximation">Short-collision time approximation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickStart.html">QuickStart</a></li>
<li class="toctree-l1"><a class="reference internal" href="usersGuide.html">User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="codingDetails.html">Coding Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional.html">Additional Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">leapr</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="incoherent-scattering-elastic-and-inelastic">
<span id="theory-incoherent"></span><h2>Incoherent Scattering (Elastic and Inelastic)<a class="headerlink" href="#incoherent-scattering-elastic-and-inelastic" title="Permalink to this headline">¶</a></h2>
<p>LEAPR describes incoherent scattering by starting with a continuous (solid-type) distribution and considering additional feautres (e.g. the existence of very sharp peaks or diffusive behavior) if necessary. The continuous calculation <em>must always be performed</em>, and additional features that can also be considered include the existence of discrete oscillators (Einstein oscillators), translative/diffusive behavior, cold Hydrogen/Deuterium, and intermolecular interference.</p>
<p>The continuous calculation will now be discussed, followed by each of the aforementioned features.</p>
<div class="section" id="continuous-treatment">
<span id="theory-incoherent-contin"></span><h3>Continuous Treatment<a class="headerlink" href="#continuous-treatment" title="Permalink to this headline">¶</a></h3>
<p>To calculate the incoherent contribution to the scattering law, the following equations must be solved,</p>
<div class="math notranslate nohighlight">
\[S^{(s)}_{n.sym}(\alpha, \beta)=\frac{1}{2 \pi} \int_{-\infty}^{\infty} \mathrm{e}^{i \beta t} \mathrm{e}^{-\gamma(t)} d t\]</div>
<div class="math notranslate nohighlight">
\[\gamma(t)=\alpha\lambda_s -\alpha \int_{-\infty}^\infty P(\beta')~\mathrm{e}^{-\beta'/2}~\mathrm{e}^{-i\beta' t}~d\beta'\]</div>
<div class="math notranslate nohighlight">
\[P(\beta)=\frac{\rho(\beta)}{2\beta\sinh(\beta/2)},\]</div>
<p>where <span class="math notranslate nohighlight">\(S^{(s)}_{n.sym}\)</span> is the non-symmetric scattering law for solids, <span class="math notranslate nohighlight">\(\rho(\beta)\)</span> is the phonon frequency distribution, and <span class="math notranslate nohighlight">\(\lambda_s\)</span> is the Debye-Waller coefficient.
.. For a introductory discussion on the phonon frequency spectrum, please see <a class="reference internal" href="additional.html#background-phonon-dos"><span class="std std-ref">Vibrational Frequency Spectrum</span></a>.</p>
<p>By Taylor expanding <span class="math notranslate nohighlight">\(\gamma(t)\)</span>, the above can be simplified to</p>
<div class="math notranslate nohighlight">
\[S^{(s)}_{n.sym}(\alpha,\beta) = \mathrm{e}^{-\alpha\lambda_s}\sum_{n=0}^\infty \frac{\alpha^n\lambda_s^n}{n!} \mathcal{T}_n(\beta)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mathcal{T}_1(\beta) = \frac{1}{\lambda_s}P(\beta)~\mathrm{e}^{-\beta/2}\qquad\mbox{and}\qquad \mathcal{T}_n(\beta) = \int_{-\infty}^\infty \mathcal{T}_1(\beta')~\mathcal{T}_{n-1}(\beta-\beta')~d\beta'.\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>What approximations are made?</strong>
In describing the scattering behavior with a continuous, solid-type spectrum, a number of approximations are made, which are summarized below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 45%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Approximation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">Gaussian</div>
<div class="line">approximation</div>
</div>
</td>
<td><div class="line-block">
<div class="line">In the definition of
<span class="math notranslate nohighlight">\(S(\alpha,\beta)\)</span>,</div>
<div class="line"><span class="math notranslate nohighlight">\(\mathrm{exp}\Big(-\alpha\gamma(t)
+\alpha^2\gamma_2(t)+\dots\Big)\)</span></div>
<div class="line">is approximated as <span class="math notranslate nohighlight">\(\mathrm{exp}
\big(-\alpha\gamma(t)\big)\)</span>.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">See Parks [REFERENCE] for more</div>
<div class="line">discussion. Not typically</div>
<div class="line">considered a significant source</div>
<div class="line">of error</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Incoherent</div>
<div class="line">approximation</div>
</div>
</td>
<td><div class="line-block">
<div class="line">While this is not an approximation made</div>
<div class="line">in the above equations, it is important</div>
<div class="line">to note that LEAPR uses the incoherent</div>
<div class="line">equations to desribe both coherent and</div>
<div class="line">incoherent scattering.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This is typically valid practice</div>
<div class="line">for materials with either low</div>
<div class="line">coherent cross sections or</div>
<div class="line">randomly-oriented crystallites.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Validity of</div>
<div class="line">phonon DOS</div>
</div>
</td>
<td><div class="line-block">
<div class="line">The continuous calculation requires an</div>
<div class="line">an input phonon spectrum, which are</div>
<div class="line">specific to material composition,</div>
<div class="line">crystalline structure, and temperature.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Before using a published phonon</div>
<div class="line">spectrum, ensure that it</div>
<div class="line">corresponds to the correct</div>
<div class="line">material, structure, and temp.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Randomly</div>
<div class="line">oriented spins</div>
</div>
</td>
<td><div class="line-block">
<div class="line">In order to separate scattering into</div>
<div class="line">coherent and incoherent components,</div>
<div class="line">spin-correlation effects are ignored.</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Spin-correlation is important</div>
<div class="line">while considering materials like</div>
<div class="line">liquid hydrogen/deuterium, which</div>
<div class="line">are considered separately later.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Edge effects</div>
<div class="line">are ignored</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Edge effects are not considered, meaning</div>
<div class="line">that the scatterer is considered to be</div>
<div class="line">infinitely large.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Ignoring edge effects is a</div>
<div class="line">standard approximations that is</div>
<div class="line">is not typically considered to</div>
<div class="line">cause significant error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Atoms of only</div>
<div class="line">one kind are</div>
<div class="line">present</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Atoms of only one kind are considered.</div>
<div class="line">Treatment for mixed moderators  will be</div>
<div class="line">discussed later.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">In a material like
<span class="math notranslate nohighlight">\(\mbox{H}_2\mbox{O}\)</span>,</div>
<div class="line">scattering from hydrogen is</div>
<div class="line">significantly more important</div>
<div class="line">than that from oxygen, so</div>
<div class="line">that only hydrogen exists is a</div>
<div class="line">valid simplification. This is</div>
<div class="line">not the case for materials like</div>
<div class="line">beryllium oxide, however.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Simplified</div>
<div class="line">crystal</div>
<div class="line">structure</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Atoms are assumed to be bound  by</div>
<div class="line">isotropic, harmonic forces in a crystal</div>
<div class="line">with cubic symmetry and one atom per</div>
<div class="line">unit cell.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This approach is applied to</div>
<div class="line">many materials that do not</div>
<div class="line">display these characteristics,</div>
<div class="line">and is believed to be an</div>
<div class="line">adequate approximation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>Want more information?</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topic</p></th>
<th class="head"><p>Resources</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">Phonon frequency</div>
<div class="line">spectrum theory</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Please see <a class="reference internal" href="additional.html#background-phonon-dos"><span class="std std-ref">Vibrational Frequency Spectrum</span></a></div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Phonon frequency</div>
<div class="line">spectrum</div>
<div class="line">availability</div>
</div>
</td>
<td><div class="line-block">
<div class="line">1. <a class="reference external" href="http://materialsproject.com/">http://materialsproject.com/</a></div>
<div class="line">2. ENDF-B/VIII release available at <a class="reference external" href="https://www.nndc.bnl.gov/endf/b8.0/">https://www.nndc.bnl.gov/endf/b8.0/</a></div>
<div class="line-block">
<div class="line">has a thermal neutron scattering sublibrary, with ENDF outputs and the</div>
<div class="line">LEAPR inputs with which the ENDF files were generated. In those LEAPR inputs</div>
<div class="line">are phonon distributions.</div>
</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Derivation of</div>
<div class="line">Phonon Expansion</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Please see <a class="reference internal" href="additional.html#additional-phonon-expansion"><span class="std std-ref">Phonon Expansion Method</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><br /></div>
</div>
</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="translational-behavior">
<h3>Translational Behavior<a class="headerlink" href="#translational-behavior" title="Permalink to this headline">¶</a></h3>
<p>Thermal neutron scattering off of liquids can be described by solving a solid-type spectrum that is combined with a diffusive term. A popular diffusive model is the “Effective Width Model”, which is defined as</p>
<div class="math notranslate nohighlight">
\[S_{n.sym}^{(t)}(\alpha,\beta) = \frac{2c\omega_t\alpha}{\pi}~\mathrm{exp}\left({2c^2\omega_t\alpha-\beta/2}\right)\sqrt{\frac{c^2+0.25}{\beta^2+4c^2\omega_t^2\alpha^2}}\mathrm{K}_1\left[\sqrt{c^2+0.25}\sqrt{\beta^2+4c^2\omega_t^2\alpha^2}\right]\]</div>
<p>with a corresponding frequency spectrum</p>
<div class="math notranslate nohighlight">
\[\rho(\beta)=\omega_t\frac{4c}{\pi\beta}\sqrt{c^2+0.25}~\sinh(\beta/2)~\mbox{K}_1\left[\sqrt{c^2+0.25}~\beta\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(K_n(x)\)</span> is the modified Bessel function of the second kind with order <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>An alternative to the effective width model is the free gas model, which is defined as</p>
<div class="math notranslate nohighlight">
\[S^{(f)}_{n.sym}(\alpha,\beta) = \frac{1}{\sqrt{4\pi\omega_t\alpha}}~\mathrm{exp}\left[-\frac{(\omega_t\alpha+\beta)^2}{4\omega_t\alpha}\right]\]</div>
<p>So to model a diffusive material, the solid-type solution obtained from the vibrational spectrum is convolved with some appropriate translative model (i.e. effective width model or free gas model).</p>
</div>
<div class="section" id="discrete-oscillators">
<span id="theory-incoherent-discre"></span><h3>Discrete Oscillators<a class="headerlink" href="#discrete-oscillators" title="Permalink to this headline">¶</a></h3>
<p>The blue region in the below figure shows the vibrational frequency spectrum for hydrogen bound in water [inspired by [CITE DAMIAN]]. Note the two prominent peaks near 0.20 eV and 0.42 eV. If a user wanted to process scattering data for this material, they could provide this full spectrum to LEAPR and have it run the full continuous calculation.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/waterPhononDOS_hatch.png"><img alt="_images/waterPhononDOS_hatch.png" src="_images/waterPhononDOS_hatch.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">The vibrational frequency spectrum for H bound in water is shown above.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>Alternatively, LEAPR allows for users to represent these higher energy peaks as discrete oscillators, also known as “Einstein oscillators”. These oscilltors are represented as weighted Dirac-<span class="math notranslate nohighlight">\(\delta\)</span> functions in the frequency distribution, which brings the blue distribution in the above figure to become the red distribution. The lower energy, continuous distribution is still the same, but the two higher energy peaks are replaced with weighted <span class="math notranslate nohighlight">\(\delta\)</span> functions (the weighting is not represented in the above figure).</p>
<p>As can be seen in the figure above, reducing the peaks to simple oscillators eliminates peak resolution and is <strong>only recommended for validating and replicating existing data</strong>.</p>
<p>The scattering law contribution from a discrete oscillator is</p>
<div class="math notranslate nohighlight">
\[S^{(i)}_{n.sym}(\alpha,\beta)=\mathrm{e}^{-\alpha\lambda_i}\sum_{n=-\infty}^\infty\delta(\beta-n\beta_i)~I_n\left[\frac{\alpha\omega_i}{\beta_i\sinh(\beta_i/2)}\right]~\mathrm{e}^{-n\beta_i/2}\]</div>
<p>which is a direct simplification of the scattering law from the continuous case (defined in Eq. [  ]).</p>
<p>To process the scattering law for a material described by discrete oscillators, the discrete ocsillator contribution <span class="math notranslate nohighlight">\(S^{(i)}_{n.sym}(\alpha,\beta)\)</span> is calcululated for each <span class="math notranslate nohighlight">\(i^{th}\)</span> oscillator. These individual contributions are convolved with the solid-type contribution <span class="math notranslate nohighlight">\(S_{n.sym}^{(s)}(\alpha,\beta)\)</span> which, in the figure above corresponds with the lower-energy part of the red distribution.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>What approximations are made?</strong>
The discrete oscillator formulation is a simplification of the continuous treatment, and thus adopts those along with additional approximations. Only the additional approximations are presented here.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 46%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Approximation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">Einstein</div>
<div class="line">crystal approx.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">The discrete oscillator approximation</div>
<div class="line">is the analytic solution for the</div>
<div class="line">scattering law, when considering a</div>
<div class="line">perfect cubic structure of atoms that</div>
<div class="line">all vibrate with the same frequency,</div>
<div class="line">thus meaning that any invoked vibrational</div>
<div class="line">frequencies must be multiples of some
<span class="math notranslate nohighlight">\(\omega\)</span>.</div>
</div>
</td>
<td><div class="line-block">
<div class="line">See Parks [REFERENCE] for more</div>
<div class="line">discussion. This has historical</div>
<div class="line">significance but is not</div>
<div class="line">recommended for modern problems</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>Want more information?</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topic</p></th>
<th class="head"><p>Resources</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">Equivalence between</div>
<div class="line">discrete oscillator</div>
<div class="line">and continuous</div>
<div class="line">treatment</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Please see <a class="reference internal" href="additional.html#additional-discrete-oscillator"><span class="std std-ref">Discrete Oscillator Method</span></a></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="coherent-scattering-elastic">
<h2>Coherent Scattering (Elastic)<a class="headerlink" href="#coherent-scattering-elastic" title="Permalink to this headline">¶</a></h2>
<p>Coherent scattering is when periodic constructive growth or destructive cancellation of the scattered waves occur. This is a difficult phenomena to model, and thus LEAPR is currently limited to describing elastic coherent scattering for the following materials:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Materials</p></th>
<th class="head"><p>Crystalline Structure</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Graphite</p></td>
<td><p>Hexagonal</p></td>
</tr>
<tr class="row-odd"><td><p>Beryllium Metal</p></td>
<td><p>Hexagonal Close-Packed (HCP)</p></td>
</tr>
<tr class="row-even"><td><p>Beryllium Oxide</p></td>
<td><p>Inter-penetrating HCP</p></td>
</tr>
<tr class="row-odd"><td><p>Aluminum</p></td>
<td><p>Face-Centered Cubic (FCC)</p></td>
</tr>
<tr class="row-even"><td><p>Lead</p></td>
<td><p>Face-Centered Cubic (FCC)</p></td>
</tr>
<tr class="row-odd"><td><p>Iron</p></td>
<td><p>Body-Centered Cubic (BCC)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The differential coherent scattering cross section is</p>
<div class="math notranslate nohighlight">
\[\sigma_{coh}(E,\mu)=\frac{\sigma_c}{E}\sum_{E_i&lt;E}f_i~\mathrm{e}^{-4W~E_i}~\delta(\mu-\mu_i)\]</div>
<p>where <span class="math notranslate nohighlight">\(W\)</span> is the effevtive Debye-Waller coefficient, <span class="math notranslate nohighlight">\(\sigma_c\)</span> is the bound coherent scattering cross section. <span class="math notranslate nohighlight">\(E_i\)</span> are Bragg Edges, defined in term</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 29%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Formula</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(W\)</span></p></td>
<td><div class="line-block">
<div class="line">Effective Debye</div>
<div class="line">Waller coefficient</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma_c\)</span></p></td>
<td><div class="line-block">
<div class="line">Bound coherent</div>
<div class="line">scattering cross</div>
<div class="line">section</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_i\)</span></p></td>
<td><div class="line-block">
<div class="line">Bragg Edges</div>
</div>
</td>
<td><p><span class="math notranslate nohighlight">\(E_i=
\frac{\hbar^2\tau_i^2}{8m}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\tau_i\)</span></p></td>
<td><div class="line-block">
<div class="line">Length of the</div>
<div class="line"><span class="math notranslate nohighlight">\(i^{th}\)</span>
reciprocal</div>
<div class="line">lattice vector</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_i\)</span></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(f_i=
\frac{2\pi\hbar^2}{4mNV}
\sum_{\tau_i}\Big|F(\tau)
\Big|^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\Big|
F(\tau)\Big|^2\)</span></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Crystallographic</div>
<div class="line">structure</div>
<div class="line">factor</div>
</div>
</td>
<td><p><span class="math notranslate nohighlight">\(|F(\tau)|^2
= \left|\sum_{j=1}^N
\mathrm{e}^{2\pi\phi_ji}\right|^2\)</span></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\sigma_l=\frac{\sigma_{coh}\lambda^2}{2\sqrt{3}a^2c}\sum_{\tau}^{\tau\leq4\pi/\lambda}\frac{m_{\tau}}{\tau}\mathrm{exp}\left[-\frac{\hbar^2\tau^2}{2M}\int_0^{\omega_{\max}}\frac{\rho(\omega)}{\omega}\mathrm{coth}\left(\frac{\omega}{k_bT}\right)\right]\frac{\left|F\right|^2}{N}\]</div>
<div class="math notranslate nohighlight">
\[\tau^2=4\pi\left[\frac{4}{3}a^2\big(l_1^2+l_2^2+l_1l_2\big)+\frac{l_3^2}{c}\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of atoms per unit cell, <span class="math notranslate nohighlight">\(\sigma_{coh}\)</span> is the coherent scattering cross section, <span class="math notranslate nohighlight">\(m_\tau\)</span> is the number of <span class="math notranslate nohighlight">\(l_1,l_2,l_3\)</span> combinations that give a reciprocal lattice vector <span class="math notranslate nohighlight">\(\tau\)</span> of equal magnitude.of equal magnitude.
<span class="math notranslate nohighlight">\(|F|^2\)</span> is the form factor of the crystal, and <span class="math notranslate nohighlight">\(a,c\)</span> are the magnitudes of the lattice vectors.</p>
<p>For hexagonal lattices,</p>
<div class="math notranslate nohighlight">
\[\left(\frac{\tau}{2\pi}\right)^2 = \left(\frac{4}{3}~a^2\right)~\Big(l_1^2+l_2^2+l_1l_2\Big) + \frac{l_3^2}{c^2}\]</div>
<p><span class="math notranslate nohighlight">\(f_i\)</span> are defined in terms of the crystallographic structure factors <span class="math notranslate nohighlight">\(F\)</span>.</p>
<div class="section" id="hexagonal-lattices">
<h3>Hexagonal Lattices<a class="headerlink" href="#hexagonal-lattices" title="Permalink to this headline">¶</a></h3>
<p>LEAPR’s treatment of hexagonal lattices is heavily influenced from the HEXSCAT code. Summary of the theory will be presented here.</p>
</div>
<div class="section" id="hexagonal-close-packed">
<h3>Hexagonal Close Packed<a class="headerlink" href="#hexagonal-close-packed" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="face-centered-cubic">
<h3>Face Centered Cubic<a class="headerlink" href="#face-centered-cubic" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="body-centered-cubic">
<h3>Body Centered Cubic<a class="headerlink" href="#body-centered-cubic" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="coherent-scattering-inelastic-approximations">
<h2>Coherent Scattering (Inelastic) Approximations<a class="headerlink" href="#coherent-scattering-inelastic-approximations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="skold-and-vineyard">
<h3>Skold and Vineyard<a class="headerlink" href="#skold-and-vineyard" title="Permalink to this headline">¶</a></h3>
<p>The incoherent approximation, which is made while using the continuous, translational, and discrete oscillator methods, ignores coherent effects. There are some material, however, in which scattered neutron waves can interfere with each other in meaningful ways. This inter-molecular coherence occurs when there is both a significant bound coherent scattering cross section (property of the atoms) as well as some correlation between the positions of nearby molecules (property of the lattice). If these requirements are met, coherent scattering may become non-negligible, at which point its effect can be accounted for by using the <strong>Vineyard</strong> or <strong>Skold</strong> approximations.</p>
<p>In these methods, the scattering law is separated into a coherent and an incoherent contribution, which are weighted using a <em>coherent fraction</em> <span class="math notranslate nohighlight">\(c\)</span>. The incoherent contribution to the scattering law can be obtained using the aforementioned methods (continuous, discrete, and translational), but the coherent contribution must be approximated.</p>
<div class="math notranslate nohighlight">
\[S(\alpha,\beta)=\big(1-c\big)S_{inc}(\alpha,\beta)+c~S_{coh}(\alpha,\beta)\]</div>
<p>The Skold approximation approximates the coherent scattering law by using the <em>static structure factor</em> <span class="math notranslate nohighlight">\(S(\kappa)\)</span> to modify the incoherent scattering law.</p>
<div class="math notranslate nohighlight">
\[S_{coh}(\alpha,\beta)=S_{inc}\left(\frac{\alpha}{S(\kappa)},\beta\right)\times S(\kappa)\]</div>
<p>The static structure factor <span class="math notranslate nohighlight">\(S(\kappa)\)</span> is a user-provided input that describes correlation in molecular positions, where <span class="math notranslate nohighlight">\(\kappa\)</span> is wave number, defined as</p>
<div class="math notranslate nohighlight">
\[\kappa = \frac{\sqrt{2Mk_bT\alpha}}{\hbar}\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the mass of the scatterer. Using these relations, the coherent-corrected scattering can be obtained by solving the above three equations for all <span class="math notranslate nohighlight">\(\alpha,\beta\)</span> values.</p>
</div>
<div class="section" id="cold-hydrogen-and-deuterium">
<h3>Cold Hydrogen and Deuterium<a class="headerlink" href="#cold-hydrogen-and-deuterium" title="Permalink to this headline">¶</a></h3>
<p>The continuous treatment equations introduced in <a class="reference internal" href="#theory-incoherent-contin"><span class="std std-ref">Continuous Treatment</span></a> were stated assuming that spins are randomly distributed. This approximation is valid for most materials, but breaks down when describing liquid hydrogen and deuterium. To correct this error, quantum mechanical treatment is required to account for spin-spin correlations for atoms in the same molecule/structure.</p>
<p>For the remainder of this discussion, “hydrogen” will refer to the element, i.e. both <span class="math notranslate nohighlight">\(^1\mathrm{H}\)</span> and <span class="math notranslate nohighlight">\(^2\mathrm{D}\)</span>.</p>
<p>For describing the spin-spin correlation for hydrogen, two cases are considered: <em>ortho</em> and <em>para</em>. Ortho hydrogen indicates that the spins of the nuclei are in the same direction, whereas para hydrogen indicates that the spins are in opposite direction.</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/orthoVsPara.png"><img alt="_images/orthoVsPara.png" src="_images/orthoVsPara.png" style="width: 40%;" /></a>
<p class="caption"><span class="caption-text">Ortho and para describe the alignment of the spins that can occur in a pair of hydrogens. Ortho corresponds to the spins going in the same direction, whereas para corresponds to them going in the opposite direction.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>There are two different scattering law equations that describe cold hydrogen scattering, depending on the relative spin directions (ortho and para).</p>
<div class="math notranslate nohighlight">
\[S_{n.sym}^{ortho}(\alpha,\beta)=\sum_{J~odd} \frac{P_J4\pi}{\sigma_b}\Big[ A_{ortho}\sum_{J'~even}F(J,J') + B_{ortho}\sum_{J'~odd} F(J,J') \Big]\]</div>
<div class="math notranslate nohighlight">
\[S_{n.sym}^{para}(\alpha,\beta)=\sum_{J~even} \frac{P_J4\pi}{\sigma_b}\Big[ A_{para}\sum_{J'~even}F(J,J') + B_{para}\sum_{J'~odd} F(J,J') \Big]\]</div>
<div class="math notranslate nohighlight">
\[F(J,J')=\big(2J'+1\big)~S_f(\omega\alpha,\beta+\beta_{JJ'})\sum_{l=\left|J'-J\right|}^{J'+J}4j_l^2(y)C^2(JJ'l;00)\]</div>
<p>Here you go</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 33%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Other Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(A
_{ortho,para}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(B
_{ortho,para}\)</span></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Summation
coefficients</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Defined in the table below as</div>
<div class="line">a function of <span class="math notranslate nohighlight">\(a_c\)</span>
and <span class="math notranslate nohighlight">\(a_i\)</span></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(a_c\)</span> and
<span class="math notranslate nohighlight">\(a_i\)</span></p></td>
<td><div class="line-block">
<div class="line">Coherent and incoherent</div>
<div class="line">scattering lengths</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Related to the coherent,</div>
<div class="line">incoherent, and total bound</div>
<div class="line">scattering cross sections via</div>
<div class="line"><span class="math notranslate nohighlight">\(\sigma_c=4\pi a_c^2\quad\)</span>
<span class="math notranslate nohighlight">\(\sigma_i=4\pi a_i^2\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(\sigma_b=\sigma_c+\sigma_i
=4\pi\big(a_c^2+a_i^2\big)\)</span></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P_J\)</span></p></td>
<td><div class="line-block">
<div class="line">Statistical weight</div>
<div class="line">factor</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta
_{JJ'}\)</span></p></td>
<td><div class="line-block">
<div class="line">Energy transfer for a</div>
<div class="line">rotational transition</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\beta_{JJ'}=
(E_{J'}-E_J)/k_bT\)</span></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(j_l(x)\)</span></p></td>
<td><div class="line-block">
<div class="line">Spherical Bessel</div>
<div class="line">function of order
<span class="math notranslate nohighlight">\(l\)</span></div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(C(
JJ';00)\)</span></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Clebsch-Gordan</div>
<div class="line">coefficient factor</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(y\)</span></p></td>
<td></td>
<td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(y=\kappa a/2\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(y=a
\sqrt{4Mk_bT\alpha/8}\)</span></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><div class="line-block">
<div class="line">Interatomic distance</div>
<div class="line">in the molecule</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\omega_t\)</span></p></td>
<td><div class="line-block">
<div class="line">Translational weight</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(1/2\)</span> for
<span class="math notranslate nohighlight">\(^1\mathrm{H}\)</span> and
<span class="math notranslate nohighlight">\(1/4\)</span> for
<span class="math notranslate nohighlight">\(^2\mathrm{D}\)</span></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S_f
(\alpha,\beta)\)</span></p></td>
<td><div class="line-block">
<div class="line">Free gas scattering law</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(S_f(\alpha,\beta)=\frac{1}
{\sqrt{4\pi\omega_t\alpha}}
\mathrm{exp}\left[-\frac{
(\omega_t\alpha+\beta)^2}
{4\omega_t\alpha}\right]\)</span></div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The summation coefficients <span class="math notranslate nohighlight">\(A_{ortho,para}\)</span> and <span class="math notranslate nohighlight">\(B_{ortho,para}\)</span> are provided for the relative materials in the table below. Here, <span class="math notranslate nohighlight">\(a_c\)</span> and <span class="math notranslate nohighlight">\(a_i\)</span> are the coherent and incoherent scattering lengths <a class="footnote-reference brackets" href="#f1" id="id2">1</a> .</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 19%" />
<col style="width: 24%" />
<col style="width: 19%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Spin Alignment</strong></p></th>
<th class="head" colspan="2"><p><span class="math notranslate nohighlight">\(^1\mathrm{H}\)</span></p></th>
<th class="head" colspan="2"><p><span class="math notranslate nohighlight">\(^2\mathrm{D}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p><span class="math notranslate nohighlight">\(A\)</span> (even)</p></td>
<td><p><span class="math notranslate nohighlight">\(B\)</span> (odd)</p></td>
<td><p><span class="math notranslate nohighlight">\(A\)</span> (even)</p></td>
<td><p><span class="math notranslate nohighlight">\(B\)</span> (odd)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Ortho</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(a_c^2/3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_c^2+2a_i^2/3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_c^2
+5a_i^2/8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3a_i^2/8\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Para</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(a_c^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_i^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3a_i^2/4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_c^2
a_i^2/4\)</span></p></td>
</tr>
</tbody>
</table>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Scattering lengths are related to bound cross sections by the surface are of a sphere. For example, if the coherent scattering length is <span class="math notranslate nohighlight">\(a_c\)</span>, then the bound coherent scattering cross section is <span class="math notranslate nohighlight">\(\sigma_{c}=4\pi a_c^2\)</span>. Furthermore, the total bound cross section <span class="math notranslate nohighlight">\(\sigma_b=\sigma_c+\sigma_i\)</span> would be equal to <span class="math notranslate nohighlight">\(4\pi(a_c^2+a_i^2)\)</span>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="special-cases-and-misc-functions">
<h2>Special Cases and Misc. Functions<a class="headerlink" href="#special-cases-and-misc-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="short-collision-time-approximation">
<h3>Short-collision time approximation<a class="headerlink" href="#short-collision-time-approximation" title="Permalink to this headline">¶</a></h3>
<p>When calculating the contribution of incoherent scattering via use of the <em>phonon expansion</em>, values corresponding to significant change in momentum (i.e. large <span class="math notranslate nohighlight">\(\alpha\)</span> values) can become costly to calculate. To avoid prohibitively costly calculations, LEAPR employs the <strong>short-collision time approximation (SCT)</strong> to describe scattering in a solid for these conditions of large momentum transfer. The SCT approximation is defined as</p>
<div class="math notranslate nohighlight">
\[S(\alpha,-\beta)=\frac{1}{\sqrt{4\pi\alpha w_s \overline{T}/T}}~\mathrm{exp}\left[-\frac{(\alpha w_s-\beta)^2}{\alpha w_s\overline{T}/T}\right]\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[S(\alpha,\beta)=\mathrm{e}^{-\beta}~S(\alpha,\beta)\]</div>
<p>where the effective temperature <span class="math notranslate nohighlight">\(\overline{T}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\overline{T}=\frac{T}{2w_s}\int_{-\infty}^\infty\beta^2P(\beta)\mathrm{e}^{-\beta}~d\beta\]</div>
<p>and <span class="math notranslate nohighlight">\(w_s\)</span> is the weight for the continuous, solid-type spectrum.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="quickStart.html" class="btn btn-neutral float-right" title="QuickStart" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright copyright stuff

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>